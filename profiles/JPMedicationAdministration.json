{
  "resourceType": "StructureDefinition",
  "id": "13fa6823-c9de-45b9-a8fa-b820544b2fae",
  "meta": {
    "lastUpdated": "2021-12-04T23:01:36.521+00:00"
  },
  "url": "http://jpfhir.jp/fhir/core/StructureDefinition/JP_MedicationAdministration",
  "version": "1.0.0",
  "name": "JP_MedicationAdministration",
  "title": "JP_MedicationAdministration",
  "status": "active",
  "date": "2021-12-04T09:26:12.4448275+00:00",
  "publisher": "FHIR® Japanese implementation research working group in Japan Association of Medical Informatics (JAMI)",
  "description": "このプロファイルはMedicationAdministrationリソースに対して、内服・外用薬剤処方投与実施情報のデータを送受信するための基礎となる制約と拡張を定めたものである。",
  "purpose": "このプロファイルはMedicationAdministrationリソースに対して、内服・外用薬剤処方投与実施情報のデータを送受信するための基礎となる制約と拡張を定めたものである。",
  "copyright": "FHIR® Japanese implementation research workaing group in Japan Association of Medical Informatics (JAMI)",
  "fhirVersion": "4.0.1",
  "mapping": [
    {
      "identity": "workflow",
      "uri": "http://hl7.org/fhir/workflow",
      "name": "Workflow Pattern"
    },
    {
      "identity": "rim",
      "uri": "http://hl7.org/v3",
      "name": "RIM Mapping"
    },
    {
      "identity": "w5",
      "uri": "http://hl7.org/fhir/fivews",
      "name": "FiveWs Pattern Mapping"
    },
    {
      "identity": "v2",
      "uri": "http://hl7.org/v2",
      "name": "HL7 v2 Mapping"
    },
    {
      "identity": "w3c.prov",
      "uri": "http://www.w3.org/ns/prov",
      "name": "W3C PROV"
    }
  ],
  "kind": "resource",
  "abstract": false,
  "type": "MedicationAdministration",
  "baseDefinition": "http://hl7.org/fhir/StructureDefinition/MedicationAdministration",
  "derivation": "constraint",
  "differential": {
    "element": [
      {
        "id": "MedicationAdministration",
        "path": "MedicationAdministration",
        "short": "患者への薬剤投与記録",
        "constraint": [
          {
            "key": "dom-2",
            "severity": "error",
            "human": "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
            "source": "DomainResource"
          },
          {
            "key": "dom-4",
            "severity": "error",
            "human": "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
            "source": "DomainResource"
          },
          {
            "key": "dom-3",
            "severity": "error",
            "human": "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
            "xpath": "not(exists(for $contained in f:contained return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
            "source": "DomainResource"
          },
          {
            "key": "dom-6",
            "severity": "warning",
            "human": "A resource should have narrative for robust management",
            "expression": "text.div.exists()",
            "source": "DomainResource"
          },
          {
            "key": "dom-5",
            "severity": "error",
            "human": "If a resource is contained in another resource, it SHALL NOT have a security label",
            "source": "DomainResource"
          }
        ]
      },
      {
        "id": "MedicationAdministration.id",
        "path": "MedicationAdministration.id",
        "type": [
          {
            "code": "id"
          }
        ],
        "condition": [
          "ele-1"
        ],
        "constraint": [
          {
            "key": "ele-1",
            "severity": "error",
            "human": "All FHIR elements must have a @value or children",
            "expression": "hasValue() or (children().count() > id.count())",
            "xpath": "@value|f:*|h:div",
            "source": "Element"
          }
        ],
        "mapping": [
          {
            "identity": "rim",
            "map": "n/a"
          }
        ]
      },
      {
        "id": "MedicationAdministration.meta",
        "path": "MedicationAdministration.meta",
        "constraint": [
          {
            "key": "ele-1",
            "severity": "error",
            "human": "All FHIR elements must have a @value or children",
            "source": "Element"
          }
        ]
      },
      {
        "id": "MedicationAdministration.implicitRules",
        "path": "MedicationAdministration.implicitRules",
        "constraint": [
          {
            "key": "ele-1",
            "severity": "error",
            "human": "All FHIR elements must have a @value or children",
            "source": "Element"
          }
        ]
      },
      {
        "id": "MedicationAdministration.language",
        "path": "MedicationAdministration.language",
        "constraint": [
          {
            "key": "ele-1",
            "severity": "error",
            "human": "All FHIR elements must have a @value or children",
            "source": "Element"
          }
        ]
      },
      {
        "id": "MedicationAdministration.text",
        "path": "MedicationAdministration.text",
        "constraint": [
          {
            "key": "ele-1",
            "severity": "error",
            "human": "All FHIR elements must have a @value or children",
            "source": "Element"
          }
        ]
      },
      {
        "id": "MedicationAdministration.extension",
        "path": "MedicationAdministration.extension",
        "slicing": {
          "discriminator": [
            {
              "type": "value",
              "path": "url"
            }
          ],
          "rules": "open"
        },
        "min": 0
      },
      {
        "id": "MedicationAdministration.extension:RequestDepartment",
        "path": "MedicationAdministration.extension",
        "sliceName": "RequestDepartment",
        "short": "依頼科",
        "definition": "依頼科を格納するための拡張",
        "min": 0,
        "max": "1",
        "type": [
          {
            "code": "Extension",
            "profile": [
              "http://jpfhir.jp/fhir/core/Extension/StructureDefinition/JP_MedicationAdministration_RequestDepartment"
            ]
          }
        ]
      },
      {
        "id": "MedicationAdministration.extension:Requester",
        "path": "MedicationAdministration.extension",
        "sliceName": "Requester",
        "short": "依頼医",
        "definition": "依頼医を格納するための拡張",
        "min": 0,
        "type": [
          {
            "code": "Extension",
            "profile": [
              "http://jpfhir.jp/fhir/core/Extension/StructureDefinition/JP_MedicationAdministration_Requester"
            ]
          }
        ]
      },
      {
        "id": "MedicationAdministration.extension:RequestAuthoredOn",
        "path": "MedicationAdministration.extension",
        "sliceName": "RequestAuthoredOn",
        "short": "依頼日時",
        "definition": "依頼日時を格納するための拡張",
        "min": 0,
        "max": "1",
        "type": [
          {
            "code": "Extension",
            "profile": [
              "http://jpfhir.jp/fhir/core/Extension/StructureDefinition/JP_MedicationAdministration_RequestAuthoredOn"
            ]
          }
        ]
      },
      {
        "id": "MedicationAdministration.extension:Location",
        "path": "MedicationAdministration.extension",
        "sliceName": "Location",
        "short": "実施場所",
        "definition": "実施場所を格納するための拡張",
        "min": 0,
        "max": "1",
        "type": [
          {
            "code": "Extension",
            "profile": [
              "http://jpfhir.jp/fhir/core/Extension/StructureDefinition/JP_MedicationAdministration_Location"
            ]
          }
        ]
      },
      {
        "id": "MedicationAdministration.identifier",
        "path": "MedicationAdministration.identifier",
        "constraint": [
          {
            "key": "ele-1",
            "severity": "error",
            "human": "All FHIR elements must have a @value or children",
            "source": "Element"
          }
        ]
      },
      {
        "id": "MedicationAdministration.instantiates",
        "path": "MedicationAdministration.instantiates",
        "constraint": [
          {
            "key": "ele-1",
            "severity": "error",
            "human": "All FHIR elements must have a @value or children",
            "source": "Element"
          }
        ]
      },
      {
        "id": "MedicationAdministration.partOf",
        "path": "MedicationAdministration.partOf",
        "constraint": [
          {
            "key": "ele-1",
            "severity": "error",
            "human": "All FHIR elements must have a @value or children",
            "source": "Element"
          },
          {
            "key": "ref-1",
            "severity": "error",
            "human": "SHALL have a contained resource if a local reference is provided",
            "expression": "reference.startsWith('#').not() or (reference.substring(1).trace('url') in %resource.contained.id.trace('ids'))",
            "source": "Reference"
          }
        ]
      },
      {
        "id": "MedicationAdministration.status",
        "path": "MedicationAdministration.status",
        "constraint": [
          {
            "key": "ele-1",
            "severity": "error",
            "human": "All FHIR elements must have a @value or children",
            "source": "Element"
          }
        ],
        "binding": {
          "strength": "required",
          "description": "患者への投与状況",
          "valueSet": "http://hl7.org/fhir/ValueSet/medication-admin-status|4.0.0"
        }
      },
      {
        "id": "MedicationAdministration.statusReason",
        "path": "MedicationAdministration.statusReason",
        "constraint": [
          {
            "key": "ele-1",
            "severity": "error",
            "human": "All FHIR elements must have a @value or children",
            "source": "Element"
          }
        ]
      },
      {
        "id": "MedicationAdministration.category",
        "path": "MedicationAdministration.category",
        "constraint": [
          {
            "key": "ele-1",
            "severity": "error",
            "human": "All FHIR elements must have a @value or children",
            "source": "Element"
          }
        ]
      },
      {
        "id": "MedicationAdministration.medication[x]",
        "path": "MedicationAdministration.medication[x]",
        "type": [
          {
            "code": "CodeableConcept"
          }
        ],
        "constraint": [
          {
            "key": "ele-1",
            "severity": "error",
            "human": "All FHIR elements must have a @value or children",
            "source": "Element"
          }
        ],
        "mustSupport": true
      },
      {
        "id": "MedicationAdministration.medication[x].coding.system",
        "path": "MedicationAdministration.medication[x].coding.system",
        "min": 1
      },
      {
        "id": "MedicationAdministration.medication[x].coding.code",
        "path": "MedicationAdministration.medication[x].coding.code",
        "min": 1
      },
      {
        "id": "MedicationAdministration.medication[x].coding.display",
        "path": "MedicationAdministration.medication[x].coding.display",
        "min": 1
      },
      {
        "id": "MedicationAdministration.subject",
        "path": "MedicationAdministration.subject",
        "constraint": [
          {
            "key": "ele-1",
            "severity": "error",
            "human": "All FHIR elements must have a @value or children",
            "source": "Element"
          },
          {
            "key": "ref-1",
            "severity": "error",
            "human": "SHALL have a contained resource if a local reference is provided",
            "expression": "reference.startsWith('#').not() or (reference.substring(1).trace('url') in %resource.contained.id.trace('ids'))",
            "source": "Reference"
          }
        ],
        "mustSupport": true
      },
      {
        "id": "MedicationAdministration.context",
        "path": "MedicationAdministration.context",
        "constraint": [
          {
            "key": "ele-1",
            "severity": "error",
            "human": "All FHIR elements must have a @value or children",
            "source": "Element"
          },
          {
            "key": "ref-1",
            "severity": "error",
            "human": "SHALL have a contained resource if a local reference is provided",
            "expression": "reference.startsWith('#').not() or (reference.substring(1).trace('url') in %resource.contained.id.trace('ids'))",
            "source": "Reference"
          }
        ]
      },
      {
        "id": "MedicationAdministration.supportingInformation",
        "path": "MedicationAdministration.supportingInformation",
        "constraint": [
          {
            "key": "ele-1",
            "severity": "error",
            "human": "All FHIR elements must have a @value or children",
            "source": "Element"
          },
          {
            "key": "ref-1",
            "severity": "error",
            "human": "SHALL have a contained resource if a local reference is provided",
            "expression": "reference.startsWith('#').not() or (reference.substring(1).trace('url') in %resource.contained.id.trace('ids'))",
            "source": "Reference"
          }
        ]
      },
      {
        "id": "MedicationAdministration.effective[x]",
        "path": "MedicationAdministration.effective[x]",
        "type": [
          {
            "code": "dateTime"
          }
        ],
        "constraint": [
          {
            "key": "ele-1",
            "severity": "error",
            "human": "All FHIR elements must have a @value or children",
            "source": "Element"
          }
        ],
        "mustSupport": true
      },
      {
        "id": "MedicationAdministration.performer",
        "path": "MedicationAdministration.performer",
        "constraint": [
          {
            "key": "ele-1",
            "severity": "error",
            "human": "All FHIR elements must have a @value or children",
            "source": "Element"
          }
        ]
      },
      {
        "id": "MedicationAdministration.performer.id",
        "path": "MedicationAdministration.performer.id",
        "type": [
          {
            "_code": {
              "extension": [
                {
                  "url": "http://hl7.org/fhir/StructureDefinition/structuredefinition-json-type",
                  "valueString": "string"
                },
                {
                  "url": "http://hl7.org/fhir/StructureDefinition/structuredefinition-xml-type",
                  "valueString": "xsd:string"
                },
                {
                  "url": "http://hl7.org/fhir/StructureDefinition/structuredefinition-rdf-type",
                  "valueString": "xsd:string"
                }
              ]
            }
          }
        ]
      },
      {
        "id": "MedicationAdministration.performer.function",
        "path": "MedicationAdministration.performer.function",
        "constraint": [
          {
            "key": "ele-1",
            "severity": "error",
            "human": "All FHIR elements must have a @value or children",
            "source": "Element"
          }
        ]
      },
      {
        "id": "MedicationAdministration.performer.actor",
        "path": "MedicationAdministration.performer.actor",
        "constraint": [
          {
            "key": "ele-1",
            "severity": "error",
            "human": "All FHIR elements must have a @value or children",
            "source": "Element"
          },
          {
            "key": "ref-1",
            "severity": "error",
            "human": "SHALL have a contained resource if a local reference is provided",
            "expression": "reference.startsWith('#').not() or (reference.substring(1).trace('url') in %resource.contained.id.trace('ids'))",
            "source": "Reference"
          }
        ]
      },
      {
        "id": "MedicationAdministration.reasonCode",
        "path": "MedicationAdministration.reasonCode",
        "constraint": [
          {
            "key": "ele-1",
            "severity": "error",
            "human": "All FHIR elements must have a @value or children",
            "source": "Element"
          }
        ]
      },
      {
        "id": "MedicationAdministration.reasonReference",
        "path": "MedicationAdministration.reasonReference",
        "constraint": [
          {
            "key": "ele-1",
            "severity": "error",
            "human": "All FHIR elements must have a @value or children",
            "source": "Element"
          },
          {
            "key": "ref-1",
            "severity": "error",
            "human": "SHALL have a contained resource if a local reference is provided",
            "expression": "reference.startsWith('#').not() or (reference.substring(1).trace('url') in %resource.contained.id.trace('ids'))",
            "source": "Reference"
          }
        ]
      },
      {
        "id": "MedicationAdministration.request",
        "path": "MedicationAdministration.request",
        "constraint": [
          {
            "key": "ele-1",
            "severity": "error",
            "human": "All FHIR elements must have a @value or children",
            "source": "Element"
          },
          {
            "key": "ref-1",
            "severity": "error",
            "human": "SHALL have a contained resource if a local reference is provided",
            "expression": "reference.startsWith('#').not() or (reference.substring(1).trace('url') in %resource.contained.id.trace('ids'))",
            "source": "Reference"
          }
        ]
      },
      {
        "id": "MedicationAdministration.device",
        "path": "MedicationAdministration.device",
        "constraint": [
          {
            "key": "ele-1",
            "severity": "error",
            "human": "All FHIR elements must have a @value or children",
            "source": "Element"
          },
          {
            "key": "ref-1",
            "severity": "error",
            "human": "SHALL have a contained resource if a local reference is provided",
            "expression": "reference.startsWith('#').not() or (reference.substring(1).trace('url') in %resource.contained.id.trace('ids'))",
            "source": "Reference"
          }
        ]
      },
      {
        "id": "MedicationAdministration.note",
        "path": "MedicationAdministration.note",
        "constraint": [
          {
            "key": "ele-1",
            "severity": "error",
            "human": "All FHIR elements must have a @value or children",
            "source": "Element"
          }
        ]
      },
      {
        "id": "MedicationAdministration.dosage",
        "path": "MedicationAdministration.dosage",
        "constraint": [
          {
            "key": "ele-1",
            "severity": "error",
            "human": "All FHIR elements must have a @value or children",
            "source": "Element"
          },
          {
            "key": "mad-1",
            "severity": "error",
            "human": "SHALL have at least one of dosage.dose or dosage.rate[x]",
            "source": "MedicationAdministration"
          }
        ]
      },
      {
        "id": "MedicationAdministration.dosage.id",
        "path": "MedicationAdministration.dosage.id",
        "type": [
          {
            "_code": {
              "extension": [
                {
                  "url": "http://hl7.org/fhir/StructureDefinition/structuredefinition-json-type",
                  "valueString": "string"
                },
                {
                  "url": "http://hl7.org/fhir/StructureDefinition/structuredefinition-xml-type",
                  "valueString": "xsd:string"
                },
                {
                  "url": "http://hl7.org/fhir/StructureDefinition/structuredefinition-rdf-type",
                  "valueString": "xsd:string"
                }
              ]
            }
          }
        ]
      },
      {
        "id": "MedicationAdministration.dosage.text",
        "path": "MedicationAdministration.dosage.text",
        "constraint": [
          {
            "key": "ele-1",
            "severity": "error",
            "human": "All FHIR elements must have a @value or children",
            "source": "Element"
          }
        ]
      },
      {
        "id": "MedicationAdministration.dosage.site",
        "path": "MedicationAdministration.dosage.site",
        "constraint": [
          {
            "key": "ele-1",
            "severity": "error",
            "human": "All FHIR elements must have a @value or children",
            "source": "Element"
          }
        ]
      },
      {
        "id": "MedicationAdministration.dosage.route",
        "path": "MedicationAdministration.dosage.route",
        "constraint": [
          {
            "key": "ele-1",
            "severity": "error",
            "human": "All FHIR elements must have a @value or children",
            "source": "Element"
          }
        ]
      },
      {
        "id": "MedicationAdministration.dosage.method",
        "path": "MedicationAdministration.dosage.method",
        "constraint": [
          {
            "key": "ele-1",
            "severity": "error",
            "human": "All FHIR elements must have a @value or children",
            "source": "Element"
          }
        ]
      },
      {
        "id": "MedicationAdministration.dosage.dose",
        "path": "MedicationAdministration.dosage.dose",
        "constraint": [
          {
            "key": "ele-1",
            "severity": "error",
            "human": "All FHIR elements must have a @value or children",
            "source": "Element"
          },
          {
            "key": "qty-3",
            "severity": "error",
            "human": "If a code for the unit is present, the system SHALL also be present",
            "source": "Quantity"
          },
          {
            "key": "sqty-1",
            "severity": "error",
            "human": "The comparator is not used on a SimpleQuantity",
            "source": "Quantity"
          }
        ]
      },
      {
        "id": "MedicationAdministration.dosage.rate[x]",
        "path": "MedicationAdministration.dosage.rate[x]",
        "constraint": [
          {
            "key": "ele-1",
            "severity": "error",
            "human": "All FHIR elements must have a @value or children",
            "source": "Element"
          },
          {
            "key": "rat-1",
            "severity": "error",
            "human": "Numerator and denominator SHALL both be present, or both are absent. If both are absent, there SHALL be some extension present",
            "expression": "(numerator.empty() xor denominator.exists()) and (numerator.exists() or extension.exists())",
            "xpath": "(count(f:numerator) = count(f:denominator)) and ((count(f:numerator) > 0) or (count(f:extension) > 0))",
            "source": "Ratio"
          }
        ]
      },
      {
        "id": "MedicationAdministration.eventHistory",
        "path": "MedicationAdministration.eventHistory",
        "constraint": [
          {
            "key": "ele-1",
            "severity": "error",
            "human": "All FHIR elements must have a @value or children",
            "source": "Element"
          },
          {
            "key": "ref-1",
            "severity": "error",
            "human": "SHALL have a contained resource if a local reference is provided",
            "expression": "reference.startsWith('#').not() or (reference.substring(1).trace('url') in %resource.contained.id.trace('ids'))",
            "source": "Reference"
          }
        ]
      }
    ]
  }
}